<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Testimoni Sahabatku Delivery</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

    :root {
      --primary: #00CAFF;
      --primary-dark: #0099cc;
      --background: #f9fbfc;
      --white: #fff;
      --gray-light: #e6e9ed;
      --gray-medium: #a3a9b8;
      --gray-dark: #3a3f55;
      --error: #e74c3c;
      --success: #27ae60;
      --shadow-light: rgba(0, 202, 255, 0.15);
      --shadow-medium: rgba(0, 202, 255, 0.3);
      --font-family: 'Inter', sans-serif;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      background: var(--background);
      font-family: var(--font-family);
      color: var(--gray-dark);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 2rem;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .container {
      background: var(--white);
      max-width: 520px;
      width: 100%;
      border-radius: 16px;
      box-shadow: 0 12px 30px var(--shadow-medium);
      padding: 3rem 3.5rem 3.5rem;
      position: relative;
      overflow: hidden;
      animation: slideFadeIn 0.8s ease forwards;
    }

    h1 {
      font-weight: 700;
      font-size: 2.25rem;
      color: var(--primary);
      margin-bottom: 2rem;
      letter-spacing: 1.1px;
      text-align: center;
      user-select: none;
      text-shadow: 0 1px 3px rgba(0, 202, 255, 0.4);
    }

    form {
      display: flex;
      flex-direction: column;
      gap: 1.75rem;
    }

    label {
      display: block;
      font-weight: 600;
      font-size: 1rem;
      margin-bottom: 0.5rem;
      color: var(--primary-dark);
      user-select: none;
    }

    input[type="text"],
    textarea,
    select {
      width: 100%;
      padding: 0.85rem 1.25rem;
      font-size: 1rem;
      font-weight: 400;
      border-radius: 12px;
      border: 2.5px solid var(--gray-light);
      background: var(--white);
      color: var(--gray-dark);
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
      font-family: var(--font-family);
      resize: vertical;
      min-height: 3.5rem;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
    }

    input[type="text"]:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 12px var(--primary);
      background: #f0fcff;
    }

    textarea {
      min-height: 120px;
      line-height: 1.5;
    }

    /* Rating Stars */
    .rating-stars {
      display: flex;
      flex-direction: row-reverse;
      justify-content: flex-start;
      gap: 0.5rem;
      user-select: none;
      font-size: 2.5rem;
      position: relative;
    }

    .rating-stars input[type="radio"] {
      display: none;
    }

    .rating-stars label {
      font-size: 2rem;
      color: #ccc;
      cursor: pointer;
      transition: color 0.3s ease;
      filter: drop-shadow(0 0 1px rgba(0,0,0,0.1));
    }

    .rating-stars label:hover,
    .rating-stars label:hover ~ label {
      color: var(--primary);
      transform: scale(1.3);
      filter: drop-shadow(0 0 6px var(--primary));
      transition: color 0.3s ease, transform 0.3s ease;
    }

    .rating-stars input[type="radio"]:checked ~ label {
      color: var(--primary);
      filter: drop-shadow(0 0 8px var(--primary));
      transform: scale(1.3);
    }

    /* Radio groups */
    .radio-group {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .radio-group input[type="radio"] {
      display: none;
    }

    .radio-group label {
      flex: 1 1 45%;
      background: var(--gray-light);
      border-radius: 14px;
      padding: 0.75rem 1.25rem;
      font-weight: 600;
      font-size: 1rem;
      color: var(--primary-dark);
      text-align: center;
      cursor: pointer;
      user-select: none;
      box-shadow: 0 0 0 2.5px var(--gray-light);
      transition:
        background-color 0.3s ease,
        color 0.3s ease,
        box-shadow 0.3s ease,
        transform 0.2s ease;
      user-select: none;
      border: 2.5px solid transparent;
    }

    .radio-group label:hover {
      background: #d0f6ff;
      box-shadow: 0 0 10px var(--primary);
      transform: translateY(-3px);
    }

    .radio-group input[type="radio"]:checked + label {
      background: var(--primary);
      color: var(--white);
      box-shadow: 0 0 20px var(--primary);
      border-color: var(--primary-dark);
      transform: translateY(-3px);
    }

    /* Error messages */
    .error-message {
      color: var(--error);
      font-size: 0.875rem;
      margin-top: 0.3rem;
      font-weight: 600;
      user-select: none;
      min-height: 1.2rem;
    }

    /* Submit button */
    button[type="submit"] {
      background: linear-gradient(135deg, #00CAFF 0%, #0099cc 100%);
      color: var(--white);
      font-weight: 700;
      font-size: 1.15rem;
      padding: 1rem 0;
      border: none;
      border-radius: 16px;
      cursor: pointer;
      box-shadow: 0 8px 25px var(--shadow-medium);
      transition: background 0.3s ease, box-shadow 0.3s ease, transform 0.2s ease;
      user-select: none;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    button[type="submit"]:hover,
    button[type="submit"]:focus {
      background: linear-gradient(135deg, #0099cc 0%, #0077aa 100%);
      box-shadow: 0 12px 30px #0077aaaa;
      transform: translateY(-3px);
      outline: none;
    }

    /* Modal */
    .modal-bg {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.55);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      animation: fadeIn 0.4s ease forwards;
      padding: 1rem;
    }

    .modal {
      background: var(--white);
      border-radius: 20px;
      max-width: 440px;
      width: 100%;
      padding: 2.5rem 3rem;
      box-shadow: 0 12px 40px var(--shadow-medium);
      text-align: center;
      user-select: none;
      animation: popIn 0.4s ease forwards;
      position: relative;
    }

    .modal h2 {
      font-size: 2rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 1rem;
      text-shadow: 0 1px 4px rgba(0, 202, 255, 0.5);
    }

    .modal p {
      font-size: 1.1rem;
      line-height: 1.5;
      color: var(--gray-dark);
      margin-bottom: 2rem;
      user-select: text;
    }

    .modal button {
      background: var(--primary);
      color: var(--white);
      font-weight: 600;
      font-size: 1rem;
      padding: 0.85rem 2.5rem;
      border-radius: 14px;
      border: none;
      cursor: pointer;
      box-shadow: 0 8px 25px var(--shadow-medium);
      transition: background 0.3s ease, box-shadow 0.3s ease, transform 0.2s ease;
      user-select: none;
    }

    .modal button:hover,
    .modal button:focus {
      background: var(--primary-dark);
      box-shadow: 0 12px 30px #0077aaaa;
      transform: translateY(-3px);
      outline: none;
    }

    /* Animations */
    @keyframes slideFadeIn {
      0% {
        opacity: 0;
        transform: translateY(40px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeIn {
      from {opacity: 0;}
      to {opacity: 1;}
    }

    @keyframes popIn {
      0% {
        opacity: 0;
        transform: scale(0.85);
      }
      100% {
        opacity: 1;
        transform: scale(1);
      }
    }

    /* Responsive */
    @media (max-width: 600px) {
      .container {
        padding: 2rem 2rem 2.5rem;
        max-width: 100%;
      }
      .radio-group label {
        flex: 1 1 100%;
      }
      h1 {
        font-size: 1.8rem;
      }
    }
  </style>
</head>
<body>
  <main class="container" role="main" aria-label="Formulir Testimoni Sahabatku Delivery">
    <h1>Testimoni Sahabatku Delivery</h1>
    <form id="testimonialForm" novalidate>
      <div>
        <label for="fullname">Nama Lengkap<span aria-hidden="true" style="color:var(--error);">*</span></label>
        <input type="text" id="fullname" name="fullname" placeholder="Masukkan nama lengkap Anda" required aria-required="true" autocomplete="name" />
        <div class="error-message" id="error-fullname" aria-live="polite"></div>
      </div>

      <fieldset>
        <legend>Seberapa puas Anda dengan pelayanan kami? <span aria-hidden="true" style="color:var(--error);">*</span></legend>
        <div class="rating-stars" role="radiogroup" aria-required="true" aria-labelledby="ratingLabel" tabindex="0">
          <input type="radio" id="star5" name="rating" value="5" />
          <label for="star5" title="5 bintang" aria-label="5 bintang">★</label>

          <input type="radio" id="star4" name="rating" value="4" />
          <label for="star4" title="4 bintang" aria-label="4 bintang">★</label>

          <input type="radio" id="star3" name="rating" value="3" />
          <label for="star3" title="3 bintang" aria-label="3 bintang">★</label>

          <input type="radio" id="star2" name="rating" value="2" />
          <label for="star2" title="2 bintang" aria-label="2 bintang">★</label>

          <input type="radio" id="star1" name="rating" value="1" />
          <label for="star1" title="1 bintang" aria-label="1 bintang">★</label>
        </div>
        <div class="error-message" id="error-rating" aria-live="polite"></div>
      </fieldset>

      <fieldset>
        <legend>Apakah kurir Sahabatku kami ramah dan sopan? <span aria-hidden="true" style="color:var(--error);">*</span></legend>
        <div class="radio-group" role="radiogroup" aria-required="true" aria-labelledby="courierLabel">
          <input type="radio" id="courier-yes" name="courier" value="Ramah dan Sopan" />
          <label for="courier-yes">Ramah dan Sopan</label>

          <input type="radio" id="courier-no" name="courier" value="Kurang Ramah/Sopan" />
          <label for="courier-no">Kurang Ramah/Sopan</label>
        </div>
        <div class="error-message" id="error-courier" aria-live="polite"></div>
      </fieldset>

      <fieldset>
        <legend>Kecepatan layanan Sahabatku Delivery hari ini? <span aria-hidden="true" style="color:var(--error);">*</span></legend>
        <div class="radio-group" role="radiogroup" aria-required="true" aria-labelledby="speedLabel">
          <input type="radio" id="speed-fast" name="speed" value="Cepat" />
          <label for="speed-fast">Cepat</label>

          <input type="radio" id="speed-avg" name="speed" value="Sedang" />
          <label for="speed-avg">Sedang</label>

          <input type="radio" id="speed-slow" name="speed" value="Lambat" />
          <label for="speed-slow">Lambat</label>
        </div>
        <div class="error-message" id="error-speed" aria-live="polite"></div>
      </fieldset>

      <div>
        <label for="comments">Pesan & Komentar (kritik & saran) <span aria-hidden="true" style="color:var(--error);">*</span></label>
        <textarea id="comments" name="comments" placeholder="Silakan tulis masukan, saran, atau keluhan Anda agar kami bisa terus memperbaiki layanan kami ke depan." required aria-required="true" aria-describedby="commentsHelp"></textarea>
        <div class="error-message" id="error-comments" aria-live="polite"></div>
      </div>

      <button type="submit" aria-label="Kirim testimoni">Kirim</button>
    </form>
  </main>
  
 <!-- Initial greeting modal -->
  <div class="modal-bg" id="welcomeModal" role="dialog" aria-modal="true" aria-labelledby="welcomeTitle" aria-describedby="welcomeDesc" tabindex="-1">
    <div class="modal">
      <h2 id="welcomeTitle">Halo!</h2>
      <p id="welcomeDesc">
        Terimakasih sudah menyempatkan waktu untuk mengisi penilaian layanan kami.<br />
        Bantu kami menjadi lebih baik dengan mengisi penilaian singkat ini yaa.<br />
        Masukan Anda sangat berarti bagi kami.
      </p>
      <button id="closeWelcomeBtn" aria-label="Tutup pesan sambutan">Mulai Mengisi</button>
    </div>
  </div>
  
  <div class="modal-bg" id="thankYouModal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-describedby="modalDesc" tabindex="-1">
    <div class="modal">
      <h2 id="modalTitle">Terimakasih!</h2>
      <p id="modalDesc">
        Terimakasih atas waktu dan kepercayaan Anda terhadap jasa layanan kami dan menjadi bagian perjalanan Sahabatku Delivery.<br />
        Masukan Anda akan kami jadikan bahan evaluasi meningkatkan pelayanan kami kedepannya.
      </p>
      <button id="closeModalBtn" aria-label="Tutup pesan terimakasih">Tutup</button>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyCtva8TeL40-WotK4kFL_vL8uUXL3GDfww",
    authDomain: "sahabatkuu-bisa.firebaseapp.com",
    databaseURL: "https://sahabatkuu-bisa-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "sahabatkuu-bisa",
    storageBucket: "sahabatkuu-bisa.firebasestorage.app",
    messagingSenderId: "315555564115",
    appId: "1:315555564115:web:56f46dbceb8c154589d4a6",
    measurementId: "G-PFGYL96VPS"
  };

  // Init Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const form = document.getElementById('testimonialForm');
  const thankYouModal = document.getElementById('thankYouModal');
  const closeModalBtn = document.getElementById('closeModalBtn');

  // Error elements
  const errors = {
    fullname: document.getElementById('error-fullname'),
    rating: document.getElementById('error-rating'),
    courier: document.getElementById('error-courier'),
    speed: document.getElementById('error-speed'),
    comments: document.getElementById('error-comments'),
  };

  function clearErrors() {
    Object.values(errors).forEach(el => el.textContent = '');
  }

  function validateForm(data) {
    clearErrors();
    let valid = true;

    if (!data.fullname.trim()) {
      errors.fullname.textContent = 'Nama lengkap wajib diisi.';
      valid = false;
    }
    if (!data.rating) {
      errors.rating.textContent = 'Mohon pilih rating bintang.';
      valid = false;
    }
    if (!data.courier) {
      errors.courier.textContent = 'Mohon pilih opsi kurir.';
      valid = false;
    }
    if (!data.speed) {
      errors.speed.textContent = 'Mohon pilih kecepatan layanan.';
      valid = false;
    }
    if (!data.comments.trim()) {
      errors.comments.textContent = 'Pesan & komentar wajib diisi.';
      valid = false;
    }

    return valid;
  }

  // Handle submit
  form.addEventListener('submit', (e) => {
    e.preventDefault();

    const data = {
      fullname: form.fullname.value,
      rating: form.rating.value,
      courier: form.courier.value,
      speed: form.speed.value,
      comments: form.comments.value,
      timestamp: Date.now()
    };

    if (validateForm(data)) {
      db.ref("testimoni").push(data)
        .then(() => {
          // Tampilkan modal terimakasih
          thankYouModal.style.display = 'flex';
          form.reset();
        })
        .catch((error) => {
          console.error("Error menyimpan data:", error);
          alert("⚠️ Gagal menyimpan testimoni. Coba lagi ya.");
        });
    }
  });

  // Tutup modal terimakasih
  closeModalBtn.addEventListener('click', () => {
    thankYouModal.style.display = 'none';
  });

  // Modal sambutan awal
  const welcomeModal = document.getElementById('welcomeModal');
  const closeWelcomeBtn = document.getElementById('closeWelcomeBtn');
  window.addEventListener('load', () => {
    welcomeModal.style.display = 'flex';
  });
  closeWelcomeBtn.addEventListener('click', () => {
    welcomeModal.style.display = 'none';
  });
</script>
